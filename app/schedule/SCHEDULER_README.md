# –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –ø—Ä–∞–∫—Ç–∏–∫ YogaDailyBot

## üéØ –û–ø–∏—Å–∞–Ω–∏–µ

–î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ –π–æ–≥–∞ –ø—Ä–∞–∫—Ç–∏–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è –∫–∞–∂–¥—ã–π –¥–µ–Ω—å.

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

#### –ù–æ–≤—ã–µ –ø–æ–ª—è –≤ —Ç–∞–±–ª–∏—Ü–µ `users`:
- `user_days` (INTEGER) - —Å—á–µ—Ç—á–∏–∫ –¥–Ω–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å 0)

#### –ù–æ–≤—ã–µ –ø–æ–ª—è –≤ —Ç–∞–±–ª–∏—Ü–µ `yoga_practices`:
- `intensity` (TEXT) - –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å –ø—Ä–∞–∫—Ç–∏–∫–∏ (–ª–µ–≥–∫–∞—è, —Å—Ä–µ–¥–Ω—è—è, –≤—ã—Å–æ–∫–∞—è –∏ —Ç.–¥.)

#### –ù–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ `practice_logs`:
- `log_id` (INTEGER PRIMARY KEY) - ID –∑–∞–ø–∏—Å–∏
- `user_id` (INTEGER) - ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `practice_id` (INTEGER) - ID –ø—Ä–∞–∫—Ç–∏–∫–∏
- `sent_at` (TIMESTAMP) - –≤—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏
- `day_number` (INTEGER) - –Ω–æ–º–µ—Ä –¥–Ω—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –ú–æ–¥—É–ª–∏

#### `app/scheduler.py`
–û—Å–Ω–æ–≤–Ω–æ–π –º–æ–¥—É–ª—å –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ —Å —Ñ—É–Ω–∫—Ü–∏—è–º–∏:
- `send_daily_practice()` - –æ—Ç–ø—Ä–∞–≤–∫–∞ –ø—Ä–∞–∫—Ç–∏–∫ –≤—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
- `send_practice_to_user()` - –æ—Ç–ø—Ä–∞–≤–∫–∞ –ø—Ä–∞–∫—Ç–∏–∫–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- `format_practice_message()` - —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- `schedule_daily_practices()` - –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö –∑–∞–¥–∞—á

#### `data/db.py`
–î–æ–ø–æ–ª–Ω–µ–Ω —Ñ—É–Ω–∫—Ü–∏—è–º–∏:
- `increment_user_days()` - —É–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞ –¥–Ω–µ–π
- `get_user_days()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –¥–Ω–µ–π
- `get_yoga_practice_by_weekday_order()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –ø–æ –ø–æ—Ä—è–¥–∫—É
- `log_practice_sent()` - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–∫–∏
- `get_user_practice_history()` - –∏—Å—Ç–æ—Ä–∏—è –ø—Ä–∞–∫—Ç–∏–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## üîÑ –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

### –í—ã–±–æ—Ä –ø—Ä–∞–∫—Ç–∏–∫
1. **–ü–æ –¥–Ω—é –Ω–µ–¥–µ–ª–∏**: –ü—Ä–∞–∫—Ç–∏–∫–∏ –≤—ã–±–∏—Ä–∞—é—Ç—Å—è –∏–∑ —Ç–µ—Ö, —É –∫–æ—Ç–æ—Ä—ã—Ö `weekday = —Ç–µ–∫—É—â–∏–π_–¥–µ–Ω—å`
2. **–ü–æ –ø–æ—Ä—è–¥–∫—É**: –ü—Ä–∞–∫—Ç–∏–∫–∏ –∏–¥—É—Ç –ø–æ –ø–æ—Ä—è–¥–∫—É –æ—Ç –Ω–∞–∏–º–µ–Ω—å—à–µ–≥–æ `practices_id` –∫ –Ω–∞–∏–±–æ–ª—å—à–µ–º—É
3. **–¶–∏–∫–ª–∏—á–Ω–æ**: –ö–æ–≥–¥–∞ –ø—Ä–∞–∫—Ç–∏–∫–∏ –∑–∞–∫–∞–Ω—á–∏–≤–∞—é—Ç—Å—è, –Ω–∞—á–∏–Ω–∞–µ–º —Å–Ω–∞—á–∞–ª–∞
4. **–ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–æ**: –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–ª—É—á–∞—é—Ç –æ–¥–Ω—É –∏ —Ç—É –∂–µ –ø—Ä–∞–∫—Ç–∏–∫—É –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –¥–µ–Ω—å

### –ü–æ–¥—Å—á–µ—Ç –¥–Ω–µ–π
- –ö–∞–∂–¥—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–º–µ–µ—Ç —Å—á–µ—Ç—á–∏–∫ –¥–Ω–µ–π (`user_days`)
- –ü—Ä–∏ –∫–∞–∂–¥–æ–π –æ—Ç–ø—Ä–∞–≤–∫–µ —Å—á–µ—Ç—á–∏–∫ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞ 1
- –ù–æ–º–µ—Ä –¥–Ω—è –¥–ª—è –≤—ã–±–æ—Ä–∞ –ø—Ä–∞–∫—Ç–∏–∫–∏ = `user_days + 1`

### –§–æ—Ä–º–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
```
{–Ω–æ–º–µ—Ä_–¥–Ω—è} –¥–µ–Ω—å

{my_description}

üåÄ {–¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å} –º–∏–Ω—É—Ç
üåÄ {–∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å}
üåÄ {–Ω–∞–∑–≤–∞–Ω–∏–µ_–∫–∞–Ω–∞–ª–∞}

‚ñ∂Ô∏è [Youtube]({—Å—Å—ã–ª–∫–∞})
```

## üöÄ –ó–∞–ø—É—Å–∫

### 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î
```bash
source venv/bin/activate
python -c "from data.postgres_db import init_database; print('–ë–î –≥–æ—Ç–æ–≤–∞')"
```

### 2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
```bash
python test_data.py
```

### 3. –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
```bash
python app/main.py
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞
```bash
python test_scheduler.py
```

### –¢–µ—Å—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø—Ä–∞–∫—Ç–∏–∫–∏ –≤ –±–æ—Ç–µ
–û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `/test` –±–æ—Ç—É –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤–æ–π –ø—Ä–∞–∫—Ç–∏–∫–∏.

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –õ–æ–≥–∏
–í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å —É—Ä–æ–≤–Ω–µ–º INFO:
- –û—Ç–ø—Ä–∞–≤–∫–∞ –ø—Ä–∞–∫—Ç–∏–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
- –û—à–∏–±–∫–∏ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ
- –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á

### –ò—Å—Ç–æ—Ä–∏—è –ø—Ä–∞–∫—Ç–∏–∫
–ú–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö –ø—Ä–∞–∫—Ç–∏–∫:
```python
from data.postgres_db import get_user_practice_history
history = get_user_practice_history(user_id, limit=10)
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å
–í—Å–µ –≤—Ä–µ–º–µ–Ω–∞ —Ä–∞–±–æ—Ç–∞—é—Ç –ø–æ –º–æ—Å–∫–æ–≤—Å–∫–æ–º—É –≤—Ä–µ–º–µ–Ω–∏ (Europe/Moscow).

### –ò–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏
–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Ä–µ–º—è –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É. –î–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `interval=60` –≤ `schedule_daily_practices()`.

## üìù –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–∫—Ç–∏–∫

### –ß–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç
```python
from data.postgres_db import add_yoga_practice

add_yoga_practice(
    title="–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏",
    video_url="https://youtu.be/...",
    time_practices=15,
    channel_name="–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞",
    my_description="–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏",
    intensity="—Å—Ä–µ–¥–Ω—è—è",
    weekday=1  # 1=–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫, 7=–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ
)
```

### –ß–µ—Ä–µ–∑ CSV
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Å–∫—Ä–∏–ø—Ç `content/bulk_add_practices.py` —Å –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–º –ø–æ–ª–µ–º `intensity`.

## üö® –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

- –ï—Å–ª–∏ –Ω–µ—Ç –ø—Ä–∞–∫—Ç–∏–∫ –¥–ª—è –¥–Ω—è –Ω–µ–¥–µ–ª–∏ - –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –æ—à–∏–±–∫–∞, –ø—Ä–∞–∫—Ç–∏–∫–∞ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è
- –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ - –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è, –Ω–æ –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç —Ä–∞–±–æ—Ç—É –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –≤ –ë–î - –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è —Å –¥–µ—Ç–∞–ª—è–º–∏

## üîÆ –ü–ª–∞–Ω—ã —Ä–∞–∑–≤–∏—Ç–∏—è

1. **–í—ã–±–æ—Ä –¥–Ω–µ–π –Ω–µ–¥–µ–ª–∏**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–º–æ–≥—É—Ç –≤—ã–±–∏—Ä–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –¥–Ω–∏ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–∞–∫—Ç–∏–∫
2. **–ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä–∞—Å—Å—ã–ª–∫–∏**: –ö–Ω–æ–ø–∫–∞ –≤ –º–µ–Ω—é –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
3. **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞**: –ü–æ–¥—Ä–æ–±–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–º –ø—Ä–∞–∫—Ç–∏–∫–∞–º
4. **–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è**: –£—á–µ—Ç –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –ø—Ä–∞–∫—Ç–∏–∫
